"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const telegraf_1 = require("telegraf");
const user_schema_1 = require("../../db/user.schema");
const text_1 = require("../text");
const composer = new telegraf_1.Composer();
composer.action("–ü–Ω", (ctx) => {
    ctx.session.day = "–ü–Ω";
    oneReaction(ctx);
});
composer.action("–í—Ç", (ctx) => {
    ctx.session.day = "–í—Ç";
    oneReaction(ctx);
});
composer.action("–°—Ä", (ctx) => {
    ctx.session.day = "–°—Ä";
    oneReaction(ctx);
});
composer.action("–ß—Ç", (ctx) => {
    ctx.session.day = "–ß—Ç";
    oneReaction(ctx);
});
composer.action("–ü—Ç", (ctx) => {
    ctx.session.day = "–ü—Ç";
    oneReaction(ctx);
});
composer.action("–°–±", (ctx) => {
    ctx.session.day = "–°–±";
    oneReaction(ctx);
});
composer.action("–ù–¥", (ctx) => {
    ctx.session.day = "–ù–¥";
    oneReaction(ctx);
});
composer.action(text_1.previousWeekText, (ctx) => {
    oneReaction(ctx);
});
composer.action(text_1.nextWeekText, (ctx) => {
    oneReaction(ctx);
});
composer.action(text_1.todayText, (ctx) => {
    oneReaction(ctx);
});
composer.action(text_1.mainMenu, (ctx) => {
    try {
        ctx.answerCbQuery().catch(() => { });
        ctx.scene.enter("welcomeScene");
    }
    catch (e) { }
});
composer.action(text_1.changeQueryBtnText, (ctx) => {
    oneReaction(ctx);
});
composer.action(text_1.manualDateBtnEntry, (ctx) => {
    oneReaction(ctx);
});
composer.action(text_1.allWeekBtnText, (ctx) => {
    oneReaction(ctx);
});
composer.action("üìå", (ctx) => {
    oneReaction(ctx);
});
function oneReaction(ctx) {
    var _a;
    try {
        ctx.session.time = 0;
        user_schema_1.Users.findById((_a = ctx.from) === null || _a === void 0 ? void 0 : _a.id)
            .then((result) => {
            var _a, _b;
            ctx.answerCbQuery().catch(() => { });
            ctx.session.oneMessageId = Number((_b = (_a = ctx.callbackQuery) === null || _a === void 0 ? void 0 : _a.message) === null || _b === void 0 ? void 0 : _b.message_id);
            ctx.session.default_value = result === null || result === void 0 ? void 0 : result.default_value;
            ctx.session.default_role = result === null || result === void 0 ? void 0 : result.default_role;
            ctx.session.default_mode = true;
            ctx.session.weekShift = 0;
            if (!ctx.session.default_value || !ctx.session.default_role)
                return ctx.scene.enter("defaultValueScene");
            ctx.scene.enter("scheduleScene");
        })
            .catch((err) => {
            ctx.reply("–©–æ—Å—å –ø—ñ—à–ª–æ –Ω–µ —Ç–∞–∫, —Å–ø—Ä–æ–±—É–π —â–µ(/start) —Ä–∞–∑ –∞–±–æ –∑–≤–µ—Ä–Ω–∏—Å—è –ø–æ –¥–æ–ø–æ–º–æ–≥—É –¥–æ —Ç–≤–æ—Ä—Ü—è –±–æ—Ç–∞");
            console.log(err);
        });
    }
    catch (error) { }
}
exports.default = composer;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWN0aW9uc0FkZC5jb21wb3Nlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9ib3QvY29tcG9zZXJzL2FjdGlvbnNBZGQuY29tcG9zZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSx1Q0FBb0M7QUFDcEMsc0RBQTZDO0FBQzdDLGtDQVFpQjtBQUdqQixNQUFNLFFBQVEsR0FBRyxJQUFJLG1CQUFRLEVBQWlCLENBQUM7QUFFL0MsUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxHQUFHLEVBQUUsRUFBRTtJQUM1QixHQUFHLENBQUMsT0FBTyxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUM7SUFDdkIsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ25CLENBQUMsQ0FBQyxDQUFDO0FBRUgsUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxHQUFHLEVBQUUsRUFBRTtJQUM1QixHQUFHLENBQUMsT0FBTyxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUM7SUFDdkIsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ25CLENBQUMsQ0FBQyxDQUFDO0FBRUgsUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxHQUFHLEVBQUUsRUFBRTtJQUM1QixHQUFHLENBQUMsT0FBTyxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUM7SUFDdkIsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ25CLENBQUMsQ0FBQyxDQUFDO0FBRUgsUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxHQUFHLEVBQUUsRUFBRTtJQUM1QixHQUFHLENBQUMsT0FBTyxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUM7SUFDdkIsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ25CLENBQUMsQ0FBQyxDQUFDO0FBRUgsUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxHQUFHLEVBQUUsRUFBRTtJ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